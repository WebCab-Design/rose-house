var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(a){return"undefined"==typeof a?"undefined":_typeof2(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"==typeof a?"undefined":_typeof2(a)};function _awaitIgnored(a,b){if(!b)return Promise.resolve(a).then(_empty)}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==("undefined"==typeof b?"undefined":_typeof2(b))||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":_typeof2(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _invoke(a,b){var c=a();return c&&c.then?c.then(b):b(c)}function _invokeIgnored(a){var b=a();if(b&&b.then)return b.then(_empty)}function _empty(){}function _await(a,b,c){return c?b?b(a):a:(a=Promise.resolve(a),b?a.then(b):a)}var _async=function(){try{if(isNaN.apply(null,{}))return function(a){return function(){try{return Promise.resolve(a.apply(this,arguments))}catch(a){return Promise.reject(a)}}}}catch(a){}return function(a){return function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];try{return Promise.resolve(a.apply(this,b))}catch(a){return Promise.reject(a)}}}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("Oxe",b):a.Oxe=b()})(this,function(){"use strict";function W(a){return{write:function(){a.element.disabled=!1}}}function Y(a){return{write:function(){a.element.disabled=!0}}}function Z(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),b===a.element.disabled)return!1},write:function(){a.element.disabled=b}}}function aa(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),!b===a.element.disabled)return!1},write:function(){a.element.disabled=!b}}}function ba(a){a.target.hasAttribute("o-value")&&Promise.resolve().then(function(){return c(a.target,"value")}).catch(console.error)}function a(a){"checkbox"!==a.target.type&&"radio"!==a.target.type&&"option"!==a.target.type&&"SELECT"!==a.target.nodeName&&a.target.hasAttribute("o-value")&&Promise.resolve().then(function(){return c(a.target,"value")}).catch(console.error)}function l(a){if(!(0!==a.button||a.defaultPrevented||"INPUT"===a.target.nodeName||"BUTTON"===a.target.nodeName||"SELECT"===a.target.nodeName||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)){var b=a.path?a.path[0]:a.target,c=b.parentNode;if(N.contain){for(;c&&"O-ROUTER"!==c.nodeName;)c=c.parentNode;if("O-ROUTER"!==c.nodeName)return}for(;b&&"A"!==b.nodeName;)b=b.parentNode;!b||"A"!==b.nodeName||b.hasAttribute("download")||b.hasAttribute("external")||b.hasAttribute("o-external")||0===b.href.indexOf("tel:")||0===b.href.indexOf("ftp:")||0===b.href.indexOf("file:")||0===b.href.indexOf("mailto:")||0!==b.href.indexOf(window.location.origin)||N.external&&("RegExp"===N.external.constructor.name&&N.external.test(b.href)||"Function"===N.external.constructor.name&&N.external(b.href)||"String"===N.external.constructor.name&&N.external===b.href)||(a.preventDefault(),N.location.href!==b.href&&Promise.resolve().then(function(){return N.route(b.href)}).catch(console.error))}}function i(a){var b=a&&a.state?a.state.path:window.location.href;Promise.resolve().then(function(){return N.route(b,{replace:!0})}).catch(console.error)}function o(a){var b=a.target;if(1===b.nodeType&&b.hasAttribute("o-load")){var c=w.resolve(b.src||b.href),d=j.data[c];j.ready(d)}}var s=_async(function(a){var b=a.target,c=k.elements.get(b).get("submit"),d=E.get(c.scope);y.formReset(b,d)}),d=_async(function(b){var c,d=b.target,e=k.elements.get(d).get("submit"),c=f.get(e.keys),g=E.get(e.scope),a=y.formData(d,g);return _await(c.call(e.container,a,b),function(b){return _invoke(function(){if("object"===("undefined"==typeof b?"undefined":_typeof(b))){var f=d.getAttribute("o-action");c=d.getAttribute("o-method");var g=d.getAttribute("o-enctype");return b.url=b.url||f,b.method=b.method||c,b.contentType=b.contentType||g,_await(T.fetch(b),function(a){return _invokeIgnored(function(){if(b.handler)return _awaitIgnored(b.handler(a))})})}},function(){(d.hasAttribute("o-reset")||"object"===("undefined"==typeof b?"undefined":_typeof(b))&&b.reset)&&d.reset()})})}),c=_async(function(a,b){if(!a)throw new Error("Oxe - requires element argument");if(!b)throw new Error("Oxe - requires attribute argument");var j=k.elements.get(a).get(b);m.batch({read:function(){var n,q=j.element.type,e=j.element.nodeName;if("SELECT"===e){var t=j.element.options,a=j.element.multiple,o=!1;n=a?[]:"";for(var s,d=0,c=t.length;d<c;d++)if(s=t[d],s.selected)if(o=!0,a)n.push(s.value);else{n=s.value;break}!t.length||a||o||(n=t[0].value)}else if("radio"===q)for(var i,l="input[type=\"radio\"][o-value=\""+j.value+"\"]",p=j.container.querySelectorAll(l),u=0,m=p.length;u<m;u++)i=p[u],j.element===i&&(n=u);else if("file"===q){var h=j.element.files;n=n||[];for(var w,g=0,f=h.length;g<f;g++)w=h[g],n.push(w)}else n="checkbox"===q?j.element.checked:j.element.value;if(void 0!==n){var v=E.get(j.keys);if(n&&"object"===("undefined"==typeof n?"undefined":_typeof(n))&&n.constructor===v.constructor){for(var b in n)if(n[b]!==v[b]){E.set(j.keys,n);break}}else v!==n&&E.set(j.keys,n)}}})}),p={splice:function(){var b=this,e=arguments[0],f=arguments[1],g=2<arguments.length?arguments.length-2:0;if("number"!=typeof e||"number"!=typeof f)return[];0>e?(e=b.length+e,e=0<e?e:0):e=e<b.length?e:b.length,0>f?f=0:f>b.length-e&&(f=b.length-e);var h,j,i,k,l=b.$meta.length,a=2,d=arguments.length-a,c=b.slice(e,f);k=l-1-e;var o=[];if(0<k)for(j=e;k--;)h=j++,i=d&&a<d?arguments[a++]:b.$meta[j],b.$meta[h]=p.create(i,b.$meta.listener,b.$meta.path+h),o.push(b.$meta.listener.bind(null,b.$meta[h],b.$meta.path+h,h));if(0<g)for(o.push(b.$meta.listener.bind(null,b.length+g,b.$meta.path.slice(0,-1),"length"));g--;)h=b.length,b.$meta[h]=p.create(arguments[a++],b.$meta.listener,b.$meta.path+h),p.defineProperty(b,h),o.push(b.$meta.listener.bind(null,b.$meta[h],b.$meta.path+h,h));if(0<f)for(o.push(b.$meta.listener.bind(null,b.length-f,b.$meta.path.slice(0,-1),"length"));f--;)b.$meta.length--,b.length--,h=b.length,o.push(b.$meta.listener.bind(null,void 0,b.$meta.path+h,h));return o.reduce(function(a,b){return a.then(b)},Promise.resolve()).catch(console.error),c},arrayProperties:function(){var a=this;return{push:{value:function(){if(!arguments.length)return this.length;for(var b=0,c=arguments.length;b<c;b++)a.splice.call(this,this.length,0,arguments[b]);return this.length}},unshift:{value:function(){if(!arguments.length)return this.length;for(var b=0,c=arguments.length;b<c;b++)a.splice.call(this,0,0,arguments[b]);return this.length}},pop:{value:function(){return this.length?a.splice.call(this,this.length-1,1):void 0}},shift:{value:function(){return this.length?a.splice.call(this,0,1):void 0}},splice:{value:a.splice}}},objectProperties:function(){var a=this;return{$get:{value:function(a){return this[a]}},$set:{value:function(b,c){if(c!==this[b]){var d=a.create(c,this.$meta.listener,this.$meta.path+b);return this.$meta[b]=d,a.defineProperty(this,b),this.$meta.listener(d,this.$meta.path+b,b),d}}},$remove:{value:function(b){if(b in this){if(this.constructor===Array)return a.splice.call(this,b,1);var c=this[b];return delete this.$meta[b],delete this[b],this.$meta.listener(void 0,this.$meta.path+b,b),c}}}}},property:function(a){var b=this;return{enumerable:!0,configurable:!0,get:function(){return this.$meta[a]},set:function(c){c!==this.$meta[a]&&(this.$meta[a]=b.create(c,this.$meta.listener,this.$meta.path+a),this.$meta.listener(this[a],this.$meta.path+a,a,this))}}},defineProperty:function(a,b){return Object.defineProperty(a,b,this.property(b))},create:function(b,f,g){var h=this;if(!b||b.constructor!==Object&&b.constructor!==Array)return b;g=g?g+".":"";var j,a,k=b.constructor,i=b.constructor(),l=b.constructor();if(l.$meta={value:b.constructor()},l.$meta.value.path=g,l.$meta.value.listener=f,k===Array){for(j=0,a=b.length;j<a;j++)l.$meta.value[j]=h.create(b[j],f,g+j),l[j]=h.property(j);var m=h.arrayProperties();for(j in m)l[j]=m[j]}if(k===Object)for(j in b)l.$meta.value[j]=h.create(b[j],f,g+j),l[j]=h.property(j);var d=h.objectProperties();for(j in d)l[j]=d[j];return Object.defineProperties(i,l)}},u=function(){function a(){_classCallCheck(this,a),this.reads=[],this.writes=[],this.time=1e3/30,this.pending=!1}return _createClass(a,[{key:"setup",value:function(a){a=a||{},this.time=a.time||this.time}},{key:"tick",value:function(a){return window.requestAnimationFrame(a)}},{key:"schedule",value:function(){this.pending||(this.pending=!0,this.tick(this.flush.bind(this,null)))}},{key:"flush",value:function(a){a=a||performance.now();for(var b;b=this.reads.shift();)if(b(),performance.now()-a>this.time)return void this.tick(this.flush.bind(this,null));for(;b=this.writes.shift();)if(b(),performance.now()-a>this.time)return void this.tick(this.flush.bind(this,null));this.reads.length||this.writes.length?performance.now()-a>this.time?this.tick(this.flush.bind(this,null)):this.flush(a):this.pending=!1}},{key:"remove",value:function(a,b){var c=a.indexOf(b);return!!~c&&!!a.splice(c,1)}},{key:"clear",value:function(a){return this.remove(this.reads,a)||this.remove(this.writes,a)}},{key:"batch",value:function(a){var b=this;if(a.read){var c=function(){var c,d=void 0;d=a.context?a.read.call(a.context):a.read(),a.write&&!1!==d&&(c=a.context?a.write.bind(a.context):a.write,b.writes.push(c),b.schedule())};b.reads.push(c),b.schedule()}else if(a.write){var d;d=a.context?a.write.bind(a.context,a.shared):a.write,b.writes.push(d),b.schedule()}return a}}]),a}(),m=new u,h={class:function(a){return{write:function(){var b=a.names.slice(1).join("-");a.element.classList.remove(b)}}},css:function(a){return{write:function(){a.element.style.cssText=""}}},default:function(a){var b;b=a.type in this?this[a.type](a):{read:function(){if(""===a.element[a.type])return!1},write:function(){a.element[a.type]=""}},m.batch(b)},disable:W,disabled:W,each:function(a){return{write:function(){for(var b;b=a.element.lastElementChild;)a.element.removeChild(b)}}},enable:Y,enabled:Y,hide:function(a){return{write:function(){a.element.hidden=!1}}},html:function(a){return{write:function(){for(var b;b=a.element.lastElementChild;)a.element.removeChild(b)}}},on:function(a){return{write:function(){a.element.removeEventListener(a.names[1],a.cache,!1)}}},read:function(a){return{write:function(){a.element.readOnly=!1}}},required:function(a){return{write:function(){a.element.required=!1}}},show:function(a){return{write:function(){a.element.hidden=!0}}},text:function(a){return{write:function(){a.element.innerText=""}}},value:function(b){return{write:function(){var c,d,e,f,a;if("SELECT"===b.element.nodeName)for(a=b.element.options,c=0,d=a.length;c<d;c++)f=a[c],f.selected=!1;else if("radio"===b.element.type)for(e="input[type=\"radio\"][o-value=\""+b.path+"\"]",a=b.element.parentNode.querySelectorAll(e),c=0,d=a.length;c<d;c++)f=a[c],f.checked=0===c;else"checkbox"===b.element.type?(b.element.checked=!1,b.element.value=!1):b.element.value=""}}},write:function(a){return{write:function(){a.element.readOnly=!0}}}},y={PREFIX:/data-o-|o-/,ROOT:/^(https?:)?\/?\//,DOT:/\.+/,PIPE:/\s?\|\s?/,PIPES:/\s?,\s?|\s+/,VARIABLE_START:"(\\|*\\,*\\s*)",VARIABLE_END:"([^a-zA-z]|$)",binderNames:function(a){return a=a.split(this.PREFIX)[1],a?a.split("-"):[]},binderValues:function(a){return a=a.split(this.PIPE)[0],a?a.split("."):[]},binderPipes:function(a){return a=a.split(this.PIPE)[1],a?a.split(this.PIPES):[]},ensureElement:function(b){b.query=b.query||"",b.scope=b.scope||document.body;var c=b.scope.querySelector(""+b.name+b.query);c||(c=document.createElement(b.name),"afterbegin"===b.position?b.scope.insertBefore(c,b.scope.firstChild):"beforeend"===b.position?b.scope.appendChild(c):b.scope.appendChild(c));var d,a=!0,f=!1;try{for(var e,g,h=b.attributes[Symbol.iterator]();!(a=(e=h.next()).done);a=!0)g=e.value,c.setAttribute(g.name,g.value)}catch(a){f=!0,d=a}finally{try{!a&&h.return&&h.return()}finally{if(f)throw d}}return c},formData:function(b,c){for(var d,e=b.querySelectorAll("[o-value]"),f={},a=0,g=e.length;a<g;a++)if(d=e[a],"OPTION"!==d.nodeName){var h=d.getAttribute("o-value");if(h){var i=this.binderValues(h);f[i[i.length-1]]=this.getByPath(c,i)}}return f},formReset:function(b,c){for(var d,e=b.querySelectorAll("[o-value]"),f=0,a=e.length;f<a;f++)if(d=e[f],"OPTION"!==d.nodeName){var g=d.getAttribute("o-value");if(g){var h=this.binderValues(g);this.setByPath(c,h,"")}}},walker:function(a,b){for(b(a),a=a.firstChild;a;)this.walker(a,b),a=a.nextSibling},replaceEachVariable:function(b,c,d,f){var e=this,g=new RegExp(this.VARIABLE_START+c+this.VARIABLE_END,"g");e.walker(b,function(b){if(3===b.nodeType)(b.nodeValue==="$"+c||"$index"===b.nodeValue)&&(b.nodeValue=f);else if(1===b.nodeType)for(var e,a=0,h=b.attributes.length;a<h;a++)e=b.attributes[a],(0===e.name.indexOf("o-")||0===e.name.indexOf("data-o-"))&&(e.value=e.value.replace(g,"$1"+d+"."+f+"$2"))})},traverse:function(b,c,d){for(var f,g="string"==typeof c?c.split("."):c,a=g.length-1,h=0;h<a;h++){if(f=g[h],!(f in b))if("function"==typeof d)d(b,f,h,g);else return;b=b[f]}return{data:b,key:g[a]}},setByPath:function(b,c,d){for(var e,f="string"==typeof c?c.split("."):c,a=f.length-1,g=0;g<a;g++)e=f[g],e in b||(isNaN(f[g+1])?b[e]={}:b[e]=[]),b=b[e];return b[f[a]]=d},getByPath:function(b,c){for(var d,e="string"==typeof c?c.split("."):c,f=e.length-1,a=0;a<f;a++){if(d=e[a],!(d in b))return;b=b[d]}return b[e[f]]},joinDot:function(){return Array.prototype.join.call(arguments,".").replace(/\.{2,}/g,".")},ready:function(a){a&&("interactive"!==document.readyState&&"complete"!==document.readyState?document.addEventListener("DOMContentLoaded",function b(){a(),document.removeEventListener("DOMContentLoaded",b)},!0):a())}},g=function(){function a(){_classCallCheck(this,a),this.data={}}return _createClass(a,[{key:"get",value:function(a){return y.getByPath(this.data,a)}},{key:"set",value:function(a,b){return y.setByPath(this.data,a,b)}}]),a}(),f=new g,v={class:function(a){var b,c;return{write:function(){b=E.get(a.keys),b=k.piper(a,b),c=a.names.slice(1).join("-"),a.element.classList.toggle(c,b)}}},css:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),1<a.names.length&&(b=a.names.slice(1).join("-")+": "+b+";"),b===a.element.style.cssText)return!1},write:function(){a.element.style.cssText=b}}},default:function(a){var b;if(a.type in this)b=this[a.type](a);else{var c;b={read:function(){return(c=E.get(a.keys),c=k.piper(a,c),void 0===c||null===c)?(E.set(a.keys,""),!1):("object"===("undefined"==typeof c?"undefined":_typeof(c))?c=JSON.stringify(c):"string"!=typeof c&&(c=c.toString()),c!==a.element[a.type]&&void 0)},write:function(){a.element[a.type]=c}}}b&&m.batch(b)},disable:Z,disabled:Z,each:function(b){if(b.cache||b.element.children.length){b.fragment||(b.fragment=document.createDocumentFragment()),b.cache||(b.cache=b.element.removeChild(b.element.firstElementChild));var c,e,f,g=this;return{read:function(){if(c=E.get(b.keys),c=k.piper(b,c),!c||"object"!==("undefined"==typeof c?"undefined":_typeof(c)))return!1;var a=b.fragment.children.length+b.element.children.length;if(a===c.length)return!1;if(a>c.length)f=!0,a--;else if(a<c.length){var h=document.importNode(b.cache,!0);if(y.replaceEachVariable(h,b.names[1],b.path,a),k.bind(h,b.container,b.scope),b.fragment.appendChild(h),a++,a===c.length&&(e=!0),"SELECT"===b.element.nodeName&&b.element.attributes["o-value"]){var i=b.element.attributes["o-value"].name,j=b.element.attributes["o-value"].value,l=k.create({name:i,value:j,scope:b.scope,element:b.element,container:b.container});g.default(l)}}return a<c.length?(g.default(b),!1):void 0},write:function(){f?b.element.removeChild(b.element.lastElementChild):e&&b.element.appendChild(b.fragment)}}}},enable:aa,enabled:aa,hide:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),b===a.element.hidden)return!1},write:function(){a.element.hidden=b}}},html:function(a){var b;return{read:function(){return(b=E.get(a.keys),b=k.piper(a,b),void 0===b||null===b)?(E.set(a.keys,""),!1):("object"===("undefined"==typeof b?"undefined":_typeof(b))?b=JSON.stringify(b):"string"!=typeof b&&(b+=""),b!==a.element.innerHTML&&void 0)},write:function(){a.element.innerHTML=b}}},on:function(b){var c;return{write:function(){return c=f.get(b.keys),"function"==typeof c?void(!b.cache&&(b.cache=function(d){for(var f,e=[d],a=0,g=b.pipes.length;a<g;a++){f=b.pipes[a].split("."),f.unshift(b.scope);var h=E.get(f);e.push(h)}Promise.resolve().then(c.bind(b.container).apply(null,e)).catch(console.error)}),b.element.removeEventListener(b.names[1],b.cache),b.element.addEventListener(b.names[1],b.cache)):(console.warn("Oxe - attribute o-on=\""+b.keys.join(".")+"\" invalid type function required"),!1)}}},read:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),b===a.element.readOnly)return!1},write:function(){a.element.readOnly=b}}},required:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),b===a.element.required)return!1},write:function(){a.element.required=b}}},show:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),!b===a.element.hidden)return!1},write:function(){a.element.hidden=!b}}},text:function(a){var b;return{read:function(){return(b=E.get(a.keys),b=k.piper(a,b),void 0===b||null===b)?(E.set(a.keys,""),!1):("object"===("undefined"==typeof b?"undefined":_typeof(b))?b=JSON.stringify(b):"string"!=typeof b&&(b=b.toString()),b!==a.element.innerText&&void 0)},write:function(){a.element.innerText=b}}},value:function(b){var c,d,e=this,f=b.element.type,g=b.element.nodeName;if("SELECT"===g){var h;return{read:function(){if(c=E.get(b.keys),c=k.piper(b,c),h=b.element.options,d=b.element.multiple,d&&c.constructor!==Array)throw new Error("Oxe - invalid multiple select value type "+b.keys.join(".")+" array required")},write:function(){for(var a,d=0,e=!1,f=0,g=h.length;f<g;f++)a=h[f],a.value===c?(e=!0,a.setAttribute("selected","")):a.hasAttribute("selected")?(d=f,a.removeAttribute("selected")):a.removeAttribute("selected");h.length&&!e&&(h[d].setAttribute("selected",""),c!==(h[d].value||"")&&E.set(b.keys,h[d].value||""))}}}if("radio"===f){var j;return{read:function(){return c=E.get(b.keys),void 0===c?(E.set(b.keys,0),!1):void(j=b.container.querySelectorAll("input[type=\"radio\"][o-value=\""+b.value+"\"]"))},write:function(){for(var a,d=!1,e=0,f=j.length;e<f;e++)a=j[e],e===c?(d=!0,a.checked=!0):a.checked=!1;d||(j[0].checked=!0,E.set(b.keys,0))}}}return"file"===f?{read:function(){return c=E.get(b.keys),void 0===c?(E.set(b.keys,[]),!1):c&&c.constructor===Array?void 0:(console.warn("Oxe - file attribute invalid type"),!1)},write:function(){for(var a=0,d=c.length;a<d;a++)c[a]!==b.element.files[a]&&(c[a]?b.element.files[a]=c[a]:console.warn("Oxe - file remove not implemented"))}}:"checkbox"===f?{read:function(){return c=E.get(b.keys),"boolean"==typeof c?c!==b.element.checked&&void 0:(E.set(b.keys,!1),!1)},write:function(){b.element.checked=c}}:{read:function(){if("OPTION"===g&&b.element.selected){var a=b.element.parentElement,d=k.elements.get(a).get("value");e.default(d)}return c=E.get(b.keys),void 0===c||null===c?(E.set(b.keys,""),!1):c!==b.element.value&&void 0},write:function(){b.element.value=c}}},write:function(a){var b;return{read:function(){if(b=E.get(a.keys),b=k.piper(a,b),!b===a.element.readOnly)return!1},write:function(){a.element.readOnly=!b}}}},b=function(){function a(){_classCallCheck(this,a),this.data={},this.elements=new Map}return _createClass(a,[{key:"create",value:function(a){var b={};if(void 0===a.name)throw new Error("Oxe.binder.create - missing name");if(void 0===a.value)throw new Error("Oxe.binder.create - missing value");if(void 0===a.scope)throw new Error("Oxe.binder.create - missing scope");if(void 0===a.element)throw new Error("Oxe.binder.create - missing element");if(void 0===a.container)throw new Error("Oxe.binder.create - missing container");return b.name=a.name,b.value=a.value,b.scope=a.scope,b.element=a.element,b.container=a.container,b.names=a.names||y.binderNames(a.name),b.pipes=a.pipes||y.binderPipes(a.value),b.values=a.values||y.binderValues(a.value),b.context={},b.path=b.values.join("."),b.type=b.type||b.names[0],b.keys=[b.scope].concat(b.values),b}},{key:"get",value:function(b){var c;if("string"==typeof b?(c={},c.scope=b.split(".").slice(0,1).join("."),c.path=b.split(".").slice(1).join(".")):c=b,!(c.scope in this.data))return null;if(!(c.path in this.data[c.scope]))return null;for(var d,f=this.data[c.scope][c.path],g=0,a=f.length;g<a;g++)if(d=f[g],d.element===c.element&&d.name===c.name)return d;return null}},{key:"add",value:function(a){if(this.elements.has(a.element)||this.elements.set(a.element,new Map),!this.elements.get(a.element).has(a.names[0]))this.elements.get(a.element).set(a.names[0],a);else return!1;a.scope in this.data||(this.data[a.scope]={}),a.path in this.data[a.scope]||(this.data[a.scope][a.path]=[]),this.data[a.scope][a.path].push(a)}},{key:"remove",value:function(a){if((this.elements.has(a.element)&&(this.elements.get(a.element).has(a.names[0])&&this.elements.get(a.element).remove(a.names[0]),0===this.elements.get(a.elements).length&&this.elements.remove(a.elements)),!!(a.scope in this.data))&&a.path in this.data[a.scope])for(var b=this.data[a.scope][a.path],c=0,d=b.length;c<d;c++)if(b[c].element===a.element)return b.splice(c,1)}},{key:"each",value:function(b,f){var g="string"==typeof b?b.split("."):b,h=g[0],a=this.data[h];if(a){var j=g.slice(1).join(".");for(var i in a)if(""===j||0===i.indexOf(j)&&(i===j||"."===i.charAt(j.length)))for(var k=a[i],l=0,d=k.length;l<d;l++)f(k[l])}}},{key:"piper",value:function(b,c){if(!b.pipes.length)return c;var d=f.get(b.scope);if(!d)return c;for(var e,g=0,a=b.pipes.length;g<a;g++)if(e=b.pipes[g],e in d)c=d[e].call(b.container,c);else throw new Error("Oxe - pipe method "+e+" not found in scope "+b.scope);return c}},{key:"skipChildren",value:function(a){if("#document-fragment"===a.nodeName)return!1;if("STYLE"===a.nodeName&&"SCRIPT"===a.nodeName&&"OBJECT"===a.nodeName&&"IFRAME"===a.nodeName)return!0;for(var b,c=0,d=a.attributes.length;c<d;c++)if(b=a.attributes[c],0===b.name.indexOf("o-each"))return!0;return!1}},{key:"eachElement",value:function(a,b){if("SLOT"!==a.nodeName&&"O-ROUTER"!==a.nodeName&&"TEMPLATE"!==a.nodeName&&"#document-fragment"!==a.nodeName&&b.call(this,a),!this.skipChildren(a))for(a=a.firstElementChild;a;)this.eachElement(a,b),a=a.nextElementSibling}},{key:"eachAttribute",value:function(b,c){for(var d,e=b.attributes,f=0,a=e.length;f<a;f++)d=e[f],0===d.name.indexOf("o-")&&"o-scope"!==d.name&&"o-reset"!==d.name&&"o-action"!==d.name&&"o-method"!==d.name&&"o-enctype"!==d.name&&c.call(this,d)}},{key:"unbind",value:function(a,b,c){if(!c)throw new Error("Oxe - unbind requires scope argument");if(!a)throw new Error("Oxe - unbind requires element argument");if(!b)throw new Error("Oxe - unbind requires container argument");this.eachElement(a,function(d){this.eachAttribute(d,function(f){var g=this.get({scope:c,element:d,container:b,name:f.name,value:f.value});this.remove(g),Unrender.default(g)})})}},{key:"bind",value:function(a,b,c){if(!c)throw new Error("Oxe - bind requires scope argument");if(!a)throw new Error("Oxe - bind requires element argument");if(!b)throw new Error("Oxe - bind requires container argument");this.eachElement(a,function(d){this.eachAttribute(d,function(f){var g=this.create({scope:c,element:d,container:b,name:f.name,value:f.value}),a=this.add(g);!1!==a&&v.default(g)})})}}]),a}(),k=new b,x=function(){function a(){_classCallCheck(this,a),this.GET=2,this.SET=3,this.REMOVE=4,this.ran=!1,this.data=p.create({},this.listener.bind(this))}return _createClass(a,[{key:"traverse",value:function(b,c,d){var e;"string"==typeof c&&(c=c.split("."));for(var f=this.data,a=c[c.length-1],g=0,h=c.length-1;g<h;g++){if(!(c[g]in f)){if(b===this.GET||b===this.REMOVE)return;b===this.SET&&f.$set(c[g],isNaN(c[g+1])?{}:[])}f=f[c[g]]}return b===this.SET?e=f.$set(a,d):b===this.GET?e=f[a]:b===this.REMOVE&&(e=f[a],f.$remove(a)),e}},{key:"get",value:function(a){return this.traverse(this.GET,a)}},{key:"remove",value:function(a){return this.traverse(this.REMOVE,a)}},{key:"set",value:function(a,b){return this.traverse(this.SET,a,b)}},{key:"listener",value:function(b,c,d){var f=void 0===b?h:v;if("length"===d){var e=c.split(".").slice(0,1).join("."),a=c.split(".").slice(1).join(".");if(!(e in k.data))return;if(!(a in k.data[e]))return;if(!(0 in k.data[e][a]))return;var g=k.data[e][a][0];f.default(g)}else k.each(c,function(a){f.default(a)})}}]),a}(),E=new x,O=function(){function a(){_classCallCheck(this,a),this.head=null,this.method="get",this.mime={xml:"text/xml; charset=utf-8",html:"text/html; charset=utf-8",text:"text/plain; charset=utf-8",json:"application/json; charset=utf-8",js:"application/javascript; charset=utf-8"}}return _createClass(a,[{key:"setup",value:function(a){a=a||{},this.head=a.head||this.head,this.method=a.method||this.method,this.path=a.path,this.origin=a.origin,this.request=a.request,this.response=a.response,this.acceptType=a.acceptType,this.credentials=a.credentials,this.contentType=a.contentType,this.responseType=a.responseType}},{key:"serialize",value:_async(function(a){var b="";for(var c in a)b=0<b.length?b+"&":b,b=b+encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return b})},{key:"fetch",value:_async(function(a){var b=this,c=Object.assign({},a);if(c.path=c.path||b.path,c.origin=c.origin||b.origin,c.path&&"string"==typeof c.path&&"/"===c.path.charAt(0)&&(c.path=c.path.slice(1)),c.origin&&"string"==typeof c.origin&&"/"===c.origin.charAt(c.origin.length-1)&&(c.origin=c.origin.slice(0,-1)),c.path&&c.origin&&!c.url&&(c.url=c.origin+"/"+c.path),!c.url)throw new Error("Oxe.fetcher - requires url or origin and path option");if(!c.method)throw new Error("Oxe.fetcher - requires method option");if(!c.head&&b.head&&(c.head=b.head),"string"==typeof c.method&&(c.method=c.method.toUpperCase()||b.method),!c.acceptType&&b.acceptType&&(c.acceptType=b.acceptType),!c.contentType&&b.contentType&&(c.contentType=b.contentType),!c.responseType&&b.responseType&&(c.responseType=b.responseType),!c.credentials&&b.credentials&&(c.credentials=b.credentials),!c.mode&&b.mode&&(c.mode=b.mode),!c.cache&&b.cache&&(c.cahce=b.cache),!c.redirect&&b.redirect&&(c.redirect=b.redirect),!c.referrer&&b.referrer&&(c.referrer=b.referrer),!c.referrerPolicy&&b.referrerPolicy&&(c.referrerPolicy=b.referrerPolicy),!c.signal&&b.signal&&(c.signal=b.signal),!c.integrity&&b.integrity&&(c.integrity=b.integrity),!c.keepAlive&&b.keepAlive&&(c.keepAlive=b.keepAlive),c.contentType)switch(c.head=c.head||{},c.contentType){case"js":c.head["Content-Type"]=b.mime.js;break;case"xml":c.head["Content-Type"]=b.mime.xml;break;case"html":c.head["Content-Type"]=b.mime.html;break;case"json":c.head["Content-Type"]=b.mime.json;break;default:c.head["Content-Type"]=c.contentType;}if(c.acceptType)switch(c.head=c.head||{},c.acceptType){case"js":c.head.Accept=b.mime.js;break;case"xml":c.head.Accept=b.mime.xml;break;case"html":c.head.Accept=b.mime.html;break;case"json":c.head.Accept=b.mime.json;break;default:c.head.Accept=c.acceptType;}return _invoke(function(){if(c.body)return _invokeIgnored(function(){if("GET"===c.method){var a=c.url+"?";return _await(b.serialize(c.body),function(b){c.url=a+b})}"json"===c.contentType&&(c.body=JSON.stringify(c.body))})},function(){var d=!1;return _invoke(function(){if("function"==typeof b.request){var a=Object.assign({},c);return _await(b.request(a),function(a){return!1===a?(d=!0,c):void("object"===("undefined"==typeof a?"undefined":_typeof(a))&&Object.assign(c,a))})}},function(e){if(d)return e;var f=Object.assign({},c);return f.head&&(f.headers=f.head,delete f.head),_await(window.fetch(c.url,f),function(a){return c.code=a.status,c.message=a.statusText,_invoke(function(){return c.responseType?_await(a["buffer"===c.responseType?"arrayBuffer":c.responseType](),function(a){c.body=a}):void(c.body=a.body)},function(){var a=!1;return _invoke(function(){if(b.response){var d=Object.assign({},c);return _await(b.response(d),function(b){return!1===b?(a=!0,c):void("object"===("undefined"==typeof b?"undefined":_typeof(b))&&Object.assign(c,b))})}},function(b){return a?b:c})})})})})})},{key:"post",value:_async(function(a){var b=this;return a.method="post",b.fetch(a)})},{key:"get",value:_async(function(a){var b=this;return a.method="get",b.fetch(a)})},{key:"put",value:_async(function(a){var b=this;return a.method="put",b.fetch(a)})},{key:"head",value:_async(function(a){var b=this;return a.method="head",b.fetch(a)})},{key:"patch",value:_async(function(a){var b=this;return a.method="patch",b.fetch(a)})},{key:"delete",value:_async(function(a){var b=this;return a.method="delete",b.fetch(a)})},{key:"options",value:_async(function(a){var b=this;return a.method="options",b.fetch(a)})},{key:"connect",value:_async(function(a){var b=this;return a.method="connect",b.fetch(a)})}]),a}(),T=new O,w={extension:function(a){var b=a.lastIndexOf(".");return 0<b?a.slice(b+1):""},join:function(){return Array.prototype.join.call(arguments,"/").replace(/\/{2,}/g,"/").replace(/^(https?:\/)/,"$1/")},base:function(a){var b=window.document.querySelector("base");return a&&(b?b.href=a:(b=window.document.createElement("base"),b.href=a,window.document.head.insertBefore(b,window.document.head.firstElementChild))),b?b.href:window.location.origin+window.location.pathname},resolve:function(b,c){var d=[];if(b=b.replace(window.location.origin,""),0===b.indexOf("https://")||0===b.indexOf("https://")||0===b.indexOf("//"))return b;"/"!==b.charAt(0)&&(c=c||this.base(),b=c+"/"+b,b=b.replace(window.location.origin,"")),b=b.replace(/\/{2,}/,"/"),b=b.replace(/^\//,""),b=b.replace(/\/$/,"");for(var e=b.split("/"),f=0,a=e.length;f<a;f++)if("."===e[f]||""===e[f])continue;else".."===e[f]?0<f&&d.splice(f-1,1):d.push(e[f]);return"/"+d.join("/")}},A={innerHandler:function(a,b,c){return"\\"===c[b-1]?void 0:"'"===a?"\\'":"\""===a?"\\\"":"\t"===a?"\\t":"\n"===a?"\\n":void 0},updateString:function(a,b,c){return c.slice(0,b)+a+c.slice(b+1)},updateIndex:function(a,b){return b+a.length-1},template:function(b){var c=b.indexOf("`"),e=b.indexOf("`",c+1);if(-1===c||-1===e)return b;for(var f,g=void 0,a=0,h=0,i=b,j=!1,k=0;k<i.length;k++)f=i[k],"`"===f&&"\\"!==i[k-1]?j?(a++,g="'",j=!1,i=this.updateString(g,k,i),k=this.updateIndex(g,k)):(h++,g="'",j=!0,i=this.updateString(g,k,i),k=this.updateIndex(g,k)):j&&(g=this.innerHandler(f,k,i))&&(i=this.updateString(g,k,i),k=this.updateIndex(g,k));if(i=i.replace(/\${(.*?)}/g,"'+$1+'"),h==a)return i;throw new Error("Oxe - Transformer missing backtick")},patterns:{exps:/export\s+(?:default|var|let|const)?\s+/g,imps:/import(?:\s+(?:\*\s+as\s+)?\w+\s+from)?\s+(?:'|").*?(?:'|")/g,imp:/import(?:\s+(?:\*\s+as\s+)?(\w+)\s+from)?\s+(?:'|")(.*?)(?:'|")/},getImports:function(b,c){for(var d,e=[],f=b.match(this.patterns.imps)||[],a=0,g=f.length;a<g;a++)d=f[a].match(this.patterns.imp),e[a]={raw:d[0],name:d[1],url:w.resolve(d[2],c),extension:w.extension(d[2])},e[a].extension||(e[a].url+=".js");return e},getExports:function(b){for(var c,d=[],e=b.match(this.patterns.exps)||[],f=0,a=e.length;f<a;f++)c=e[f],d[f]={raw:c,default:-1!==c.indexOf("default")};return d},replaceImports:function(b,c){if(!c.length)return b;for(var d=0,e=c.length;d<e;d++){var f=c[d],a=(f.name?"var "+f.name+" = ":"")+"$LOADER.data['"+f.url+"'].result";b=b.replace(f.raw,a)}return b},replaceExports:function(a,b){if(!b.length)return a;if(1===b.length)return a.replace(b[0].raw,"return ");a="var $EXPORT = {};\n"+a,a+="\nreturn $EXPORT;\n";for(var c=0,d=b.length;c<d;c++)a=a.replace(b[c].raw,"$EXPORT.");return a},ast:function(a){var b={};return b.url=a.url,b.raw=a.text,b.cooked=a.text,b.base=b.url.slice(0,b.url.lastIndexOf("/")+1),b.imports=this.getImports(b.raw,b.base),b.exports=this.getExports(b.raw),b.cooked=this.replaceImports(b.cooked,b.imports),b.cooked=this.replaceExports(b.cooked,b.exports),b}},S=function(){function a(){_classCallCheck(this,a),this.events={}}return _createClass(a,[{key:"on",value:function(a,b){a in this.events||(this.events[a]=[]),this.events[a].push(b)}},{key:"off",value:function(a,b){if(a in this.events){var c=this.events[a].indexOf(b);-1!==c&&this.events[a].splice(c,1)}}},{key:"emit",value:function(b){if(b in this.events)for(var c=this.events[b],d=Array.prototype.slice.call(arguments,1),e=0,f=c.length;e<f;e++)c[e].apply(this,d)}}]),a}(),C=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.data={},a.ran=!1,a.methods={},a.transformers={},a}return _inherits(b,a),_createClass(b,[{key:"setup",value:function(a){if(a=a||{},this.methods=a.methods||this.methods,this.transformers=a.transformers||this.transformers,a.loads)for(var b;b=a.loads.shift();)this.load(b)}},{key:"execute",value:function(a){var b="'use strict';\n\n"+(a.ast?a.ast.cooked:a.text),c=new Function("$LOADER","window",b);a.result=c(this,window)}},{key:"ready",value:function(a){if(a&&a.listener&&a.listener.length)for(var b;b=a.listener.shift();)b(a)}},{key:"fetch",value:function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState)if(200<=c.status&&300>c.status||304==c.status)a.text=c.responseText,"js"===a.extension?a.transformer?b.transform(a,function(){b.execute(a),b.ready(a)}):(b.execute(a),b.ready(a)):b.ready(a);else throw new Error(c.responseText)},c.open("GET",a.url),c.send()}},{key:"transform",value:function(b,c){if(("es"===b.transformer||"est"===b.transformer)&&(b.text=A.template(b.text)),("es"===b.transformer||"esm"===b.transformer)&&(b.ast=A.ast(b)),b.ast&&b.ast.imports.length)for(var d=0,e=b.ast.imports.length,f=function(){d++,d===e&&c()},g=0;g<e;g++)this.load({listener:f,method:b.method,url:b.ast.imports[g].url,transformer:b.transformer});else c()}},{key:"attach",value:function(a){var b=document.createElement(a.tag);for(var c in a.attributes["o-load"]="true",a.attributes)b.setAttribute(c,a.attributes[c]);document.head.appendChild(b)}},{key:"js",value:function(a){"fetch"===a.method||"es"===a.transformer||"est"===a.transformer||"esm"===a.transformer?this.fetch(a):"script"===a.method?this.attach({tag:"script",attributes:{type:"text/javascript",src:a.url,async:"true"}}):this.attach({tag:"script",attributes:{type:"module",src:a.url,async:"true"}})}},{key:"css",value:function(a){"fetch"===a.method?this.fetch(a):this.attach({tag:"link",attributes:{href:a.url,type:"text/css",rel:"stylesheet"}})}},{key:"load",value:function(a,b){if("string"==typeof a?a={url:a}:b=a.listener,a.url=w.resolve(a.url),a.url in this.data){var c=this.data[a.url];return void(c.listener.length?b&&c.listener.push(b):(b&&c.listener.push(b),this.ready(c)))}this.data[a.url]=a,a.extension=a.extension||w.extension(a.url),a.listener=b?[b]:[],a.method=a.method||this.methods[a.extension],a.transformer=a.transformer||this.transformers[a.extension],"js"===a.extension?this.js(a):"css"===a.extension?this.css(a):this.fetch(a)}}]),b}(S),j=new C,$=function(){function a(){_classCallCheck(this,a),this.data={},this.compiled=!1}return _createClass(a,[{key:"setup",value:function(a){if(a=a||{},a.components&&a.components.length)for(var b=0,c=a.components.length;b<c;b++)this.define(a.components[b])}},{key:"renderSlot",value:function(b,c){for(var d=b.querySelectorAll("slot[name]"),e=0,f=d.length;e<f;e++){var a=d[e],g=a.getAttribute("name"),h=c.querySelector("[slot=\""+g+"\"]");h?a.parentNode.replaceChild(h,a):a.parentNode.removeChild(a)}var i=b.querySelector("slot:not([name])");if(i){if(c.children.length)for(i.parentNode.setAttribute("slot","default");c.firstChild;)i.parentNode.insertBefore(c.firstChild,i);i.parentNode.removeChild(i)}}},{key:"renderStyle",value:function(b,c){if(!b)return"";if(window.CSS&&window.CSS.supports){if(!window.CSS.supports("(--t: black)"))for(var d=b.match(/--\w+(?:-+\w+)*:\s*.*?;/g),f=0,g=d.length;f<g;f++){var a=d[f],h=a.match(/(--\w+(?:-+\w+)*):\s*(.*?);/),i=new RegExp("var\\("+h[1]+"\\)","g");b=b.replace(h[0],""),b=b.replace(i,h[2])}window.CSS.supports(":scope")||(b=b.replace(/\:scope/g,"[o-scope=\""+c+"\"]")),window.CSS.supports(":host")||(b=b.replace(/\:host/g,"[o-scope=\""+c+"\"]"))}return"<style>"+b+"</style>"}},{key:"created",value:function(b,c){var d=this,e=c.name+"-"+c.count++;if(Object.defineProperties(b,{scope:{value:e,enumerable:!0}}),b.setAttribute("o-scope",e),E.set(e,c.model),f.set(e,c.methods),d.compiled&&"O-ROUTER"===b.parentElement.nodeName)k.bind(b,b,e);else{var g=document.createElement("template"),a=d.renderStyle(c.style,e);"string"==typeof c.template?g.innerHTML=a+c.template:(g.innerHTML=a,g.appendChild(c.template));var h=document.importNode(g.content,!0);k.bind(h,b,e),c.shadow?"attachShadow"in document.body?b.attachShadow({mode:"open"}).appendChild(h):"createShadowRoot"in document.body&&b.createShadowRoot().appendChild(h):(d.renderSlot(h,b),b.appendChild(h))}c.created&&c.created.call(b)}},{key:"attached",value:function(a,b){b.attached&&b.attached.call(a)}},{key:"detached",value:function(a,b){b.detached&&b.detached.call(a)}},{key:"define",value:function(a){var b=this;if(!a.name)throw new Error("Oxe.component.define - requires name");if(a.name in b.data)throw new Error("Oxe.component.define - component defined");return b.data[a.name]=a,a.count=0,a.compiled=!1,a.style=a.style||"",a.model=a.model||{},a.methods=a.methods||{},a.shadow=a.shadow||!1,a.template=a.template||"",a.properties=a.properties||{},a.properties.model={enumerable:!0,configurable:!0,get:function(){return E.get(this.scope)},set:function(a){return a=a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))?a:{},E.set(this.scope,a)}},a.properties.methods={enumerable:!0,get:function(){return f.get(this.scope)}},a.proto=Object.create(HTMLElement.prototype,a.properties),a.proto.attributeChangedCallback=a.attributed,a.proto.createdCallback=function(){b.created(this,a)},a.proto.attachedCallback=function(){b.attached(this,a)},a.proto.detachedCallback=function(){b.detached(this,a)},document.registerElement(a.name,{prototype:a.proto})}}]),a}(),P=new $,q=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.data=[],a.location={},a.ran=!1,a.mode="push",a.element=null,a.contain=!1,a}return _inherits(b,a),_createClass(b,[{key:"setup",value:_async(function(a){var b=this;return a=a||{},b.mode=void 0===a.mode?b.mode:a.mode,b.after=void 0===a.after?b.after:a.after,b.before=void 0===a.before?b.before:a.before,b.element=void 0===a.element?b.element:a.element,b.contain=void 0===a.contain?b.contain:a.contain,b.external=void 0===a.external?b.external:a.external,a.routes&&b.add(a.routes),_awaitIgnored(b.route(window.location.href,{mode:"replace"}))})},{key:"scroll",value:function(a,b){window.scroll(a,b)}},{key:"back",value:function(){window.history.back()}},{key:"forward",value:function(){window.history.forward()}},{key:"redirect",value:function(a){window.location.href=a}},{key:"add",value:function(a){if(!a)throw new Error("Oxe.router.add - requires data parameter");else if(a.constructor===Object){if(!a.path)throw new Error("Oxe.router.add - route path required");if(!a.component)throw new Error("Oxe.router.add - route component required");this.data.push(a)}else if(a.constructor===Array)for(var b=0,c=a.length;b<c;b++)this.add(a[b])}},{key:"remove",value:function(a){for(var b=0,c=this.data.length;b<c;b++)a===this.data[b].path&&this.data.splice(b,1)}},{key:"get",value:function(a){for(var b,c=0,d=this.data.length;c<d;c++)if(b=this.data[c],a===b.path)return b}},{key:"find",value:function(a){for(var b,c=0,d=this.data.length;c<d;c++)if(b=this.data[c],this.isPath(b.path,a))return b}},{key:"filter",value:function(b){for(var c,d=[],e=0,f=this.data.length;e<f;e++)c=this.data[e],this.isPath(c.path,b)&&d.push(c);return d}},{key:"isPath",value:function(a,b){return("/"!==a.slice(0,1)&&(a=w.resolve(a)),!!b)&&("String"===b.constructor.name?new RegExp("^"+a.replace(/{\*}/g,"(?:.*)").replace(/{(\w+)}/g,"([^/]+)")+"(/)?$").test(b||"/"):"RegExp"===b.constructor.name?b.test(a):void 0)}},{key:"toParameterObject",value:function(b,c){var f={};if(!b||!c||"/"===b||"/"===c)return f;for(var g=/{|}/g,h=/{(\w+)}/,a=c.split("/"),j=b.split("/"),k=0,d=j.length;k<d;k++)if(h.test(j[k])){var i=j[k].replace(g,"");f[i]=a[k]}return f}},{key:"toQueryString",value:function(a){var b="?";for(var c in a){var d=a[c];b+=c+"="+d+"&"}return"&"===b.slice(-1)&&(b=b.slice(0,-1)),b}},{key:"toQueryObject",value:function(b){var c={};0===b.indexOf("?")&&(b=b.slice(1));for(var d,e=b.split("&"),f=0,a=e.length;f<a;f++)d=e[f].split("="),d[0]&&d[1]&&(c[d[0]]=d[1]);return c}},{key:"toLocationObject",value:function(a){var b=document.createElement("a");return b.href=a,{href:b.href,host:b.host,port:b.port,hash:b.hash,search:b.search,protocol:b.protocol,hostname:b.hostname,pathname:b.pathname}}},{key:"render",value:function(a){var b=this;if(!a)throw new Error("Oxe.render - route argument required");y.ready(function(){if(a.title&&(document.title=a.title),a.description&&y.ensureElement({name:"meta",scope:document.head,position:"afterbegin",query:"[name=\"description\"]",attributes:[{name:"name",value:"description"},{name:"content",value:a.description}]}),a.keywords&&y.ensureElement({name:"meta",scope:document.head,position:"afterbegin",query:"[name=\"keywords\"]",attributes:[{name:"name",value:"keywords"},{name:"content",value:a.keywords}]}),!b.element&&(b.element=b.element||"o-router","string"==typeof b.element&&(b.element=document.body.querySelector(b.element)),!b.element))throw new Error("Oxe.router.render - missing o-router element");if(!a.element)if(a.load&&j.load(a.load),!a.component)throw new Error("Oxe.router.render - missing route component");else a.component.constructor===String?a.element=document.createElement(a.component):a.component.constructor===Object&&(P.define(a.component),a.element="compiled"===b.mode?b.element.firstChild:document.createElement(a.component.name));for(;b.element.firstChild;)b.element.removeChild(b.element.firstChild);b.element.appendChild(a.element),b.scroll(0,0),b.emit("routed"),"function"==typeof b.after&&Promise.resolve(b.after).catch(console.error)})}},{key:"route",value:_async(function(b,c){var d=this,f=!1;c=c||{};var g=c.mode||d.mode,a=d.toLocationObject(b),h=d.find(a.pathname);if(!h)throw new Error("Oxe.router.route - route not found");return a.route=h,a.title=a.route.title,a.query=d.toQueryObject(a.search),a.parameters=d.toParameterObject(a.route.path,a.pathname),c.query&&(b+=d.toQueryString(c.query)),_invoke(function(){if("function"==typeof d.before)return _await(d.before(a),function(a){!1===a&&(f=!0)})},function(c){var h=!1;return f?c:_invoke(function(){if(a.route&&a.route.handler)return h=!0,_await(a.route.handler(a))},function(c){return h?c:a.route&&a.route.redirect?d.redirect(a.route.redirect):"href"===g||"compiled"===g?window.location.assign(b):void(window.history[g+"State"]({path:b},"",b),d.location=a,d.emit("routing"),d.render(a.route))})})})}]),b}(S),N=new q,L=function(){function a(){_classCallCheck(this,a),this.compiled=!1}return _createClass(a,[{key:"setup",value:function(a){a=a||{},a.base&&w.base(a.base)}}]),a}(),R=new L,I=document.createElement("style"),_=document.createTextNode("\n\to-router, o-router > :first-child {\n\t\tdisplay: block;\n\t\tanimation: o-transition 150ms ease-in-out;\n\t}\n\t@keyframes o-transition {\n\t\t0% { opacity: 0; }\n\t\t100% { opacity: 1; }\n\t}\n");I.setAttribute("type","text/css"),I.appendChild(_),document.head.appendChild(I);var V=document.querySelector("script[o-setup]");if(V){var B=0,D=0,M=function(){if(B==D){var a=V.getAttribute("o-setup").split(/\s*,\s*/),b=document.querySelector("meta[name=\"oxe\"]");if(b&&b.hasAttribute("compiled")&&(a[1]="null",a[2]="script",N.mode="compiled",R.compiled=!0,P.compiled=!0),!a[0])throw new Error("Oxe - o-setup attribute requires a url");if(1<a.length)j.load({url:a[0],method:a[2],transformer:a[1]});else{var c=document.createElement("script");c.setAttribute("src",a[0]),c.setAttribute("async","true"),c.setAttribute("type","module"),document.head.appendChild(c)}document.registerElement("o-router",{prototype:Object.create(HTMLElement.prototype)})}},U=function(a,b){var c=document.createElement("script");c.setAttribute("async","true"),c.setAttribute("src",a),c.addEventListener("load",function(){B++,b()},!0),document.head.appendChild(c)},F=[],G=!("fetch"in window),H=!("assign"in Object),X=!("Promise"in window),z=!("registerElement"in document)||!("content"in document.createElement("template"));G&&F.push("fetch"),X&&F.push("Promise"),H&&F.push("Object.assign"),(X||G||H)&&(D++,U("https://cdn.polyfill.io/v2/polyfill.min.js?features="+F.join(","),M)),z&&(D++,U("https://cdnjs.cloudflare.com/ajax/libs/document-register-element/1.7.2/document-register-element.js",M)),M()}else document.registerElement("o-router",{prototype:Object.create(HTMLElement.prototype)});var K=function(){function b(){_classCallCheck(this,b),this.g={}}return _createClass(b,[{key:"setup",value:_async(function(b){var c=this;if(!c._setup)return c._setup=!0,b=b||{},b.listener=b.listener||{},document.addEventListener("load",o,!0),document.addEventListener("input",a,!0),document.addEventListener("click",l,!0),document.addEventListener("change",ba,!0),window.addEventListener("popstate",i,!0),document.addEventListener("reset",function(a){if(a.target.hasAttribute("o-reset")){a.preventDefault();var c,d;b.listener.reset&&(c="function"==typeof b.listener.reset.before?b.listener.reset.before.bind(null,a):null,d="function"==typeof b.listener.reset.after?b.listener.reset.after.bind(null,a):null),Promise.resolve().then(c).then(s.bind(null,a)).then(d).catch(console.error)}},!0),document.addEventListener("submit",function(a){if(a.target.hasAttribute("o-submit")){a.preventDefault();var c,e;b.listener.submit&&(c="function"==typeof b.listener.submit.before?b.listener.submit.before.bind(null,a):null,e="function"==typeof b.listener.submit.after?b.listener.submit.after.bind(null,a):null),Promise.resolve().then(c).then(d.bind(null,a)).then(e).catch(console.error)}},!0),_invoke(function(){if(b.listener.before)return _awaitIgnored(b.listener.before())},function(){return b.general&&c.general.setup(b.general),b.fetcher&&c.fetcher.setup(b.fetcher),b.loader&&c.loader.setup(b.loader),b.component&&c.component.setup(b.component),_invoke(function(){if(b.router)return _awaitIgnored(c.router.setup(b.router))},function(){return _invokeIgnored(function(){if(b.listener.after)return _awaitIgnored(b.listener.after())})})})})},{key:"global",get:function(){return this.g}},{key:"window",get:function(){return window}},{key:"document",get:function(){return window.document}},{key:"body",get:function(){return window.document.body}},{key:"head",get:function(){return window.document.head}},{key:"location",get:function(){return this.router.location}},{key:"currentScript",get:function(){return window.document._currentScript||window.document.currentScript}},{key:"ownerDocument",get:function(){return(window.document._currentScript||window.document.currentScript).ownerDocument}},{key:"render",get:function(){return v}},{key:"methods",get:function(){return f}},{key:"utility",get:function(){return y}},{key:"general",get:function(){return R}},{key:"batcher",get:function(){return m}},{key:"loader",get:function(){return j}},{key:"binder",get:function(){return k}},{key:"fetcher",get:function(){return T}},{key:"component",get:function(){return P}},{key:"router",get:function(){return N}},{key:"model",get:function(){return E}}]),b}(),Q=new K;return Q});